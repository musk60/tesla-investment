{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER-PC/OneDrive/Documents/ANTIGRA/tesla-investment/app/api/invest/route.js"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { getUsers, saveUsers, getInvestments } from '../../../../lib/data';\r\n\r\nexport async function POST(request) {\r\n    const { email, planId, amount } = await request.json();\r\n    const users = getUsers();\r\n    const plans = getInvestments();\r\n\r\n    const userIndex = users.findIndex(u => u.email === email);\r\n    if (userIndex === -1) {\r\n        return NextResponse.json({ error: 'User not found' }, { status: 404 });\r\n    }\r\n\r\n    const plan = plans.find(p => p.id === planId);\r\n    if (!plan) {\r\n        return NextResponse.json({ error: 'Plan not found' }, { status: 404 });\r\n    }\r\n\r\n    if (amount < plan.minInvestment) {\r\n        return NextResponse.json({ error: `Minimum investment is $${plan.minInvestment}` }, { status: 400 });\r\n    }\r\n\r\n    const newInvestment = {\r\n        id: Date.now(),\r\n        planId: plan.id,\r\n        name: plan.name,\r\n        investedAmount: Number(amount),\r\n        currentValue: Number(amount), // Starts at invested amount\r\n        dateInvested: new Date().toISOString().split('T')[0]\r\n    };\r\n\r\n    users[userIndex].activePlans.push(newInvestment);\r\n    users[userIndex].totalInvested += Number(amount);\r\n    users[userIndex].currentValue += Number(amount);\r\n\r\n    saveUsers(users);\r\n\r\n    return NextResponse.json({ success: true, investment: newInvestment });\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;;;;;;;AAGO,eAAe,KAAK,OAAO;IAC9B,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,QAAQ,IAAI;IACpD,MAAM,QAAQ;IACd,MAAM,QAAQ;IAEd,MAAM,YAAY,MAAM,SAAS,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK;IACnD,IAAI,cAAc,CAAC,GAAG;QAClB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAiB,GAAG;YAAE,QAAQ;QAAI;IACxE;IAEA,MAAM,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;IACtC,IAAI,CAAC,MAAM;QACP,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAiB,GAAG;YAAE,QAAQ;QAAI;IACxE;IAEA,IAAI,SAAS,KAAK,aAAa,EAAE;QAC7B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,CAAC,uBAAuB,EAAE,KAAK,aAAa,EAAE;QAAC,GAAG;YAAE,QAAQ;QAAI;IACtG;IAEA,MAAM,gBAAgB;QAClB,IAAI,KAAK,GAAG;QACZ,QAAQ,KAAK,EAAE;QACf,MAAM,KAAK,IAAI;QACf,gBAAgB,OAAO;QACvB,cAAc,OAAO;QACrB,cAAc,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;IACxD;IAEA,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC;IAClC,KAAK,CAAC,UAAU,CAAC,aAAa,IAAI,OAAO;IACzC,KAAK,CAAC,UAAU,CAAC,YAAY,IAAI,OAAO;IAExC,UAAU;IAEV,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,SAAS;QAAM,YAAY;IAAc;AACxE"}}]
}