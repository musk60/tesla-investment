{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/tesla-investment/styles/AdminChat.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"activeChat\": \"AdminChat-module__iRfAKa__activeChat\",\n  \"adminMessage\": \"AdminChat-module__iRfAKa__adminMessage\",\n  \"chatArea\": \"AdminChat-module__iRfAKa__chatArea\",\n  \"chatId\": \"AdminChat-module__iRfAKa__chatId\",\n  \"chatItem\": \"AdminChat-module__iRfAKa__chatItem\",\n  \"chatList\": \"AdminChat-module__iRfAKa__chatList\",\n  \"container\": \"AdminChat-module__iRfAKa__container\",\n  \"input\": \"AdminChat-module__iRfAKa__input\",\n  \"inputArea\": \"AdminChat-module__iRfAKa__inputArea\",\n  \"lastMessage\": \"AdminChat-module__iRfAKa__lastMessage\",\n  \"message\": \"AdminChat-module__iRfAKa__message\",\n  \"messages\": \"AdminChat-module__iRfAKa__messages\",\n  \"noChatSelected\": \"AdminChat-module__iRfAKa__noChatSelected\",\n  \"sendButton\": \"AdminChat-module__iRfAKa__sendButton\",\n  \"timestamp\": \"AdminChat-module__iRfAKa__timestamp\",\n  \"userMessage\": \"AdminChat-module__iRfAKa__userMessage\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER-PC/OneDrive/Documents/ANTIGRA/tesla-investment/app/admin/chat/page.js"],"sourcesContent":["'use client';\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport styles from '../../../styles/AdminChat.module.css';\r\n\r\nexport default function AdminChat() {\r\n    const [chats, setChats] = useState([]);\r\n    const [selectedChatId, setSelectedChatId] = useState(null);\r\n    const [messages, setMessages] = useState([]);\r\n    const [input, setInput] = useState('');\r\n    const messagesEndRef = useRef(null);\r\n\r\n    // Poll for active chats\r\n    useEffect(() => {\r\n        fetchChats();\r\n        const interval = setInterval(fetchChats, 5000);\r\n        return () => clearInterval(interval);\r\n    }, []);\r\n\r\n    // Poll for messages in selected chat\r\n    useEffect(() => {\r\n        if (selectedChatId) {\r\n            fetchMessages(selectedChatId);\r\n            const interval = setInterval(() => fetchMessages(selectedChatId), 3000);\r\n            return () => clearInterval(interval);\r\n        }\r\n    }, [selectedChatId]);\r\n\r\n    const fetchChats = async () => {\r\n        try {\r\n            const res = await fetch('/api/chat');\r\n            if (res.ok) {\r\n                const data = await res.json();\r\n                setChats(data.chats || []);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching chats:', error);\r\n        }\r\n    };\r\n\r\n    const fetchMessages = async (id) => {\r\n        try {\r\n            const res = await fetch(`/api/chat?chatId=${id}`);\r\n            if (res.ok) {\r\n                const data = await res.json();\r\n                setMessages(data.messages || []);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching messages:', error);\r\n        }\r\n    };\r\n\r\n    const scrollToBottom = () => {\r\n        messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n    };\r\n\r\n    useEffect(() => {\r\n        scrollToBottom();\r\n    }, [messages]);\r\n\r\n    const handleSend = async (e) => {\r\n        e.preventDefault();\r\n        if (!input.trim() || !selectedChatId) return;\r\n\r\n        const newMessage = {\r\n            text: input,\r\n            sender: 'admin',\r\n            timestamp: new Date().toISOString()\r\n        };\r\n\r\n        // Optimistic update\r\n        setMessages([...messages, newMessage]);\r\n        setInput('');\r\n\r\n        try {\r\n            await fetch('/api/chat', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ chatId: selectedChatId, message: newMessage })\r\n            });\r\n            fetchMessages(selectedChatId); // Sync\r\n        } catch (error) {\r\n            console.error('Error sending message:', error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <div className={styles.chatList}>\r\n                {chats.map(chat => (\r\n                    <div\r\n                        key={chat.id}\r\n                        className={`${styles.chatItem} ${selectedChatId === chat.id ? styles.activeChat : ''}`}\r\n                        onClick={() => setSelectedChatId(chat.id)}\r\n                    >\r\n                        <div className={styles.chatId}>User: {chat.id.substr(5)}</div>\r\n                        <div className={styles.lastMessage}>\r\n                            {chat.lastMessage?.text || 'No messages'}\r\n                        </div>\r\n                        <div className={styles.timestamp}>\r\n                            {chat.lastMessage?.timestamp ? new Date(chat.lastMessage.timestamp).toLocaleTimeString() : ''}\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n                {chats.length === 0 && (\r\n                    <div style={{ padding: '1rem', color: '#888', textAlign: 'center' }}>\r\n                        No active chats\r\n                    </div>\r\n                )}\r\n            </div>\r\n            <div className={styles.chatArea}>\r\n                {selectedChatId ? (\r\n                    <>\r\n                        <div className={styles.messages}>\r\n                            {messages.map((msg, index) => (\r\n                                <div\r\n                                    key={index}\r\n                                    className={`${styles.message} ${msg.sender === 'admin' ? styles.adminMessage : styles.userMessage}`}\r\n                                >\r\n                                    {msg.text}\r\n                                </div>\r\n                            ))}\r\n                            <div ref={messagesEndRef} />\r\n                        </div>\r\n                        <form onSubmit={handleSend} className={styles.inputArea}>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={input}\r\n                                onChange={(e) => setInput(e.target.value)}\r\n                                placeholder=\"Type a reply...\"\r\n                                className={styles.input}\r\n                            />\r\n                            <button type=\"submit\" disabled={!input.trim()} className={styles.sendButton}>\r\n                                Send\r\n                            </button>\r\n                        </form>\r\n                    </>\r\n                ) : (\r\n                    <div className={styles.noChatSelected}>\r\n                        Select a chat to view messages\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}