(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,30037,e=>{e.v({activeChat:"AdminChat-module__cyIL8W__activeChat",adminMessage:"AdminChat-module__cyIL8W__adminMessage",chatArea:"AdminChat-module__cyIL8W__chatArea",chatId:"AdminChat-module__cyIL8W__chatId",chatItem:"AdminChat-module__cyIL8W__chatItem",chatList:"AdminChat-module__cyIL8W__chatList",container:"AdminChat-module__cyIL8W__container",input:"AdminChat-module__cyIL8W__input",inputArea:"AdminChat-module__cyIL8W__inputArea",lastMessage:"AdminChat-module__cyIL8W__lastMessage",message:"AdminChat-module__cyIL8W__message",messages:"AdminChat-module__cyIL8W__messages",noChatSelected:"AdminChat-module__cyIL8W__noChatSelected",sendButton:"AdminChat-module__cyIL8W__sendButton",timestamp:"AdminChat-module__cyIL8W__timestamp",userMessage:"AdminChat-module__cyIL8W__userMessage"})},4926,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(30037);function i(){let[e,i]=(0,a.useState)([]),[l,c]=(0,a.useState)(null),[d,n]=(0,a.useState)([]),[r,m]=(0,a.useState)(""),o=(0,a.useRef)(null);(0,a.useEffect)(()=>{h();let e=setInterval(h,5e3);return()=>clearInterval(e)},[]),(0,a.useEffect)(()=>{if(l){u(l);let e=setInterval(()=>u(l),3e3);return()=>clearInterval(e)}},[l]);let h=async()=>{try{let e=await fetch("/api/chat");if(e.ok){let t=await e.json();i(t.chats||[])}}catch(e){console.error("Error fetching chats:",e)}},u=async e=>{try{let t=await fetch(`/api/chat?chatId=${e}`);if(t.ok){let e=await t.json();n(e.messages||[])}}catch(e){console.error("Error fetching messages:",e)}};(0,a.useEffect)(()=>{o.current?.scrollIntoView({behavior:"smooth"})},[d]);let _=async e=>{if(e.preventDefault(),!r.trim()||!l)return;let t={text:r,sender:"admin",timestamp:new Date().toISOString()};n([...d,t]),m("");try{await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chatId:l,message:t})}),u(l)}catch(e){console.error("Error sending message:",e)}};return(0,t.jsxs)("div",{className:s.default.container,children:[(0,t.jsxs)("div",{className:s.default.chatList,children:[e.map(e=>(0,t.jsxs)("div",{className:`${s.default.chatItem} ${l===e.id?s.default.activeChat:""}`,onClick:()=>c(e.id),children:[(0,t.jsxs)("div",{className:s.default.chatId,children:["User: ",e.id.substr(5)]}),(0,t.jsx)("div",{className:s.default.lastMessage,children:e.lastMessage?.text||"No messages"}),(0,t.jsx)("div",{className:s.default.timestamp,children:e.lastMessage?.timestamp?new Date(e.lastMessage.timestamp).toLocaleTimeString():""})]},e.id)),0===e.length&&(0,t.jsx)("div",{style:{padding:"1rem",color:"#888",textAlign:"center"},children:"No active chats"})]}),(0,t.jsx)("div",{className:s.default.chatArea,children:l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:s.default.messages,children:[d.map((e,a)=>(0,t.jsx)("div",{className:`${s.default.message} ${"admin"===e.sender?s.default.adminMessage:s.default.userMessage}`,children:e.text},a)),(0,t.jsx)("div",{ref:o})]}),(0,t.jsxs)("form",{onSubmit:_,className:s.default.inputArea,children:[(0,t.jsx)("input",{type:"text",value:r,onChange:e=>m(e.target.value),placeholder:"Type a reply...",className:s.default.input}),(0,t.jsx)("button",{type:"submit",disabled:!r.trim(),className:s.default.sendButton,children:"Send"})]})]}):(0,t.jsx)("div",{className:s.default.noChatSelected,children:"Select a chat to view messages"})})]})}e.s(["default",()=>i])}]);