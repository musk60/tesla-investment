(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,25099,e=>{e.v({activeChat:"AdminChat-module__iRfAKa__activeChat",adminMessage:"AdminChat-module__iRfAKa__adminMessage",chatArea:"AdminChat-module__iRfAKa__chatArea",chatId:"AdminChat-module__iRfAKa__chatId",chatItem:"AdminChat-module__iRfAKa__chatItem",chatList:"AdminChat-module__iRfAKa__chatList",container:"AdminChat-module__iRfAKa__container",input:"AdminChat-module__iRfAKa__input",inputArea:"AdminChat-module__iRfAKa__inputArea",lastMessage:"AdminChat-module__iRfAKa__lastMessage",message:"AdminChat-module__iRfAKa__message",messages:"AdminChat-module__iRfAKa__messages",noChatSelected:"AdminChat-module__iRfAKa__noChatSelected",sendButton:"AdminChat-module__iRfAKa__sendButton",timestamp:"AdminChat-module__iRfAKa__timestamp",userMessage:"AdminChat-module__iRfAKa__userMessage"})},58534,e=>{"use strict";var a=e.i(30445),t=e.i(87483),s=e.i(25099);function i(){let[e,i]=(0,t.useState)([]),[l,d]=(0,t.useState)(null),[n,r]=(0,t.useState)([]),[c,m]=(0,t.useState)(""),o=(0,t.useRef)(null);(0,t.useEffect)(()=>{h();let e=setInterval(h,5e3);return()=>clearInterval(e)},[]),(0,t.useEffect)(()=>{if(l){u(l);let e=setInterval(()=>u(l),3e3);return()=>clearInterval(e)}},[l]);let h=async()=>{try{let e=await fetch("/api/chat");if(e.ok){let a=await e.json();i(a.chats||[])}}catch(e){console.error("Error fetching chats:",e)}},u=async e=>{try{let a=await fetch(`/api/chat?chatId=${e}`);if(a.ok){let e=await a.json();r(e.messages||[])}}catch(e){console.error("Error fetching messages:",e)}};(0,t.useEffect)(()=>{o.current?.scrollIntoView({behavior:"smooth"})},[n]);let _=async e=>{if(e.preventDefault(),!c.trim()||!l)return;let a={text:c,sender:"admin",timestamp:new Date().toISOString()};r([...n,a]),m("");try{await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chatId:l,message:a})}),u(l)}catch(e){console.error("Error sending message:",e)}};return(0,a.jsxs)("div",{className:s.default.container,children:[(0,a.jsxs)("div",{className:s.default.chatList,children:[e.map(e=>(0,a.jsxs)("div",{className:`${s.default.chatItem} ${l===e.id?s.default.activeChat:""}`,onClick:()=>d(e.id),children:[(0,a.jsxs)("div",{className:s.default.chatId,children:["User: ",e.id.substr(5)]}),(0,a.jsx)("div",{className:s.default.lastMessage,children:e.lastMessage?.text||"No messages"}),(0,a.jsx)("div",{className:s.default.timestamp,children:e.lastMessage?.timestamp?new Date(e.lastMessage.timestamp).toLocaleTimeString():""})]},e.id)),0===e.length&&(0,a.jsx)("div",{style:{padding:"1rem",color:"#888",textAlign:"center"},children:"No active chats"})]}),(0,a.jsx)("div",{className:s.default.chatArea,children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:s.default.messages,children:[n.map((e,t)=>(0,a.jsx)("div",{className:`${s.default.message} ${"admin"===e.sender?s.default.adminMessage:s.default.userMessage}`,children:e.text},t)),(0,a.jsx)("div",{ref:o})]}),(0,a.jsxs)("form",{onSubmit:_,className:s.default.inputArea,children:[(0,a.jsx)("input",{type:"text",value:c,onChange:e=>m(e.target.value),placeholder:"Type a reply...",className:s.default.input}),(0,a.jsx)("button",{type:"submit",disabled:!c.trim(),className:s.default.sendButton,children:"Send"})]})]}):(0,a.jsx)("div",{className:s.default.noChatSelected,children:"Select a chat to view messages"})})]})}e.s(["default",()=>i])}]);